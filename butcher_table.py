#!/usr/bin/env python3
import numpy as np
from precision import precision     # for myfloat

myfloat = type(precision(1))

# this script writes a list of butcher tables to file, which are read in by the ode solver



# standard RK methods (explicit):

# low order (1-3)
#--------------------------------------------------------------------------------------------------
euler_1 = np.array([
                [0, 0],
                [1, 1]], dtype = myfloat)

heun_2 = np.array([
                [0, 0, 0],
                [1, 1, 0],
                [1, 1/2, 1/2]], dtype = myfloat)

midpoint_2 = np.array([
                [0, 0, 0],
                [1/2, 1/2, 0],
                [1, 0, 1]], dtype = myfloat)

ralston_2 = np.array([
                [0, 0, 0],
                [2/3, 2/3, 0],
                [1, 1/4, 3/4]], dtype = myfloat)

heun_3 = np.array([
                [0, 0, 0, 0],
                [1/3, 1/3, 0, 0],
                [2/3, 0, 2/3, 0],
                [1, 1/4, 0, 3/4]], dtype = myfloat)

ralston_3 = np.array([
                [0, 0, 0, 0],
                [1/2, 1/2, 0, 0],
                [3/4, 0, 3/4, 0],
                [1, 2/9, 1/3, 4/9]], dtype = myfloat)

runge_kutta_3 = np.array([
                [0, 0, 0, 0],
                [1/2, 1/2, 0, 0],
                [1, -1, 2, 0],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

# ssp = strong stability preserving
ssp_shu_osher_3 = np.array([
                [0, 0, 0, 0],
                [1, 1, 0, 0],
                [1/2, 1/4, 1/4, 0],
                [1, 1/6, 1/6, 2/3]], dtype = myfloat)

ssp_spiteri_ruuth_3 = np.array([
                [0, 0, 0, 0, 0],
                [1/2, 1/2, 0, 0, 0],
                [1, 1/2, 1/2, 0, 0],
                [1/2, 1/6, 1/6, 1/6, 0],
                [1, 1/6, 1/6, 1/6, 1/2]], dtype = myfloat)
#--------------------------------------------------------------------------------------------------



# mid order (4-6)
#--------------------------------------------------------------------------------------------------
runge_kutta_4 = np.array([
                [0, 0, 0, 0, 0],
                [1/2, 1/2, 0, 0, 0],
                [1/2, 0, 1/2, 0, 0],
                [1, 0, 0, 1, 0],
                [1, 1/6, 1/3, 1/3, 1/6]], dtype = myfloat)

three_eights_rule_4 = np.array([
                [0, 0, 0, 0, 0],
                [1/3, 1/3, 0, 0, 0],
                [2/3, -1/3, 1, 0, 0],
                [1, 1, -1, 1, 0],
                [1, 1/8, 3/8, 3/8, 1/8]], dtype = myfloat)

ralston_4 = np.array([
                [0, 0, 0, 0, 0],
                [0.4, 0.4, 0, 0, 0],
                [0.4557372542187894, 0.2969776092477536, 0.15875964497103556, 0, 0],
                [1, 0.21810038822592054, -3.050965148692931, 3.8328647604670123, 0],
                [1, 0.1747602822626904, -0.551480662878733, 1.2055355993965235, 0.17118478121951902]], dtype = myfloat)

ssp_ketcheson_4 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/6, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/3, 1/6, 1/6, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/2, 1/6, 1/6, 1/6, 0, 0, 0, 0, 0, 0, 0],
                [2/3, 1/6, 1/6, 1/6, 1/6, 0, 0, 0, 0, 0, 0],
                [1/3, 1/15, 1/15, 1/15, 1/15, 1/15, 0, 0, 0, 0, 0],
                [1/2, 1/15, 1/15, 1/15, 1/15, 1/15, 1/6, 0, 0, 0, 0],
                [2/3, 1/15, 1/15, 1/15, 1/15, 1/15, 1/6, 1/6, 0, 0, 0],
                [5/6, 1/15, 1/15, 1/15, 1/15, 1/15, 1/6, 1/6, 1/6, 0, 0],
                [1, 1/15, 1/15, 1/15, 1/15, 1/15, 1/6, 1/6, 1/6, 1/6, 0],
                [1, 1/10, 1/10, 1/10, 1/10, 1/10, 1/10, 1/10, 1/10, 1/10, 1/10]], dtype = myfloat)

fehlberg_4 = np.array([
                [0, 0, 0, 0, 0, 0],
                [1/4, 1/4, 0, 0, 0, 0],
                [3/8, 3/32, 9/32, 0, 0, 0],
                [12/13, 1932/2197, -7200/2197, 7296/2197, 0, 0],
                [1, 439/216, -8, 3680/513, -845/4104, 0],
                [1, 25/216, 0, 1408/2565, 2197/4104, -1/5]], dtype = myfloat)

butcher_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/4, 1/4, 0, 0, 0, 0, 0],
                [1/4, 1/8, 1/8, 0, 0, 0, 0],
                [1/2, 0, -1/2, 1, 0, 0, 0],
                [3/4, 3/16, 0, 0, 9/16, 0, 0],
                [1, -3/7, 2/7, 12/7, -12/7, 8/7, 0],
                [1, 7/90, 0, 32/90, 12/90, 32/90, 7/90]], dtype = myfloat)

cash_karp_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/5, 1/5, 0, 0, 0, 0, 0],
                [3/10, 3/40, 9/40, 0, 0, 0, 0],
                [3/5, 3/10, -9/10, 6/5, 0, 0, 0],
                [1, -11/54, 5/2, -70/27, 35/27, 0, 0],
                [7/8, 1631/55296, 175/512, 575/13824, 44275/110592, 253/4096, 0],
                [1, 37/378, 0, 250/621, 125/594, 0, 512/1771]], dtype = myfloat)

dormand_prince_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/5, 1/5, 0, 0, 0, 0, 0],
                [3/10, 3/40, 9/40, 0, 0, 0, 0],
                [4/5, 44/45, -56/15, 32/9, 0, 0, 0],
                [8/9, 19372/6561, -25360/2187, 64448/6561, -212/729, 0, 0],
                [1, 9017/3168, -355/33, 46732/5247, 49/176, -5103/18656, 0],
                [1, 35/384, 0, 500/1113, 125/192, -2187/6784, 11/84]], dtype = myfloat)

bogacki_shampine_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/6, 0, 0, 0, 0, 0, 0],
                [2/9, 2/27, 4/27, 0, 0, 0, 0, 0],
                [3/7, 183/1372, -162/343, 1053/1372, 0, 0, 0, 0],
                [2/3, 68/297, -4/11, 42/143, 1960/3861, 0, 0, 0],
                [3/4, 597/22528, 81/352, 63099/585728, 58653/366080, 4617/20480, 0, 0],
                [1, 174197/959244, -30942/79937, 8152137/19744439, 666106/1039181, -29421/29068, 482048/414219, 0],
                [1, 587/8064, 0, 4440339/15491840, 24353/124800, 387/44800, 2152/5985, 7267/94080]], dtype = myfloat)

tsitouras_5 = np.array([
                  [0, 0, 0, 0, 0, 0, 0],
                  [0.161, 0.161, 0, 0, 0, 0, 0],
                  [0.327, -8.4806554923569887e-03, 3.3548065549235700e-01, 0, 0, 0, 0],
                  [0.9, 2.8971530571054935, -6.3594484899750752, 4.3622954328695815, 0, 0, 0],
                  [9.8002554090450966e-01, 5.3258648284392569, -1.1748883564062828e+01, 7.4955393428898365, -9.2495066361755252e-02, 0, 0],
                  [1, 5.8614554429464203, -1.2920969317847110e+01, 8.1593678985761589, -7.1584973281400996e-02, -2.8269050394068383e-02, 0],
                  [1, 9.6460766818065230e-02, 0.01, 4.7988965041449960e-01, 1.3790085741037419, -3.2900695154360808, 2.3247105240997739]], dtype = myfloat)

# from Verner 1978 paper
verner_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/18, 1/18, 0, 0, 0, 0, 0],
                [1/6, -1/12, 1/4, 0, 0, 0, 0],
                [2/9, -2/81, 4/27, 8/81, 0, 0, 0],
                [2/3, 40/33, -4/11, -56/11, 54/11, 0, 0],
                [1, -369/73, 72/73, 5380/219, -12285/584, 2695/1752, 0],
                [1, 3/80, 0, 4/25, 243/1120, 77/160, 73/700]], dtype = myfloat)

butcher_6 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0],
                [1/2, 1/2, 0, 0, 0, 0, 0, 0],
                [2/3, 2/9, 4/9, 0, 0, 0, 0, 0],
                [1/3, 7/36, 2/9, -1/12, 0, 0, 0, 0],
                [5/6, -35/144, -55/36, 35/48, 15/8, 0, 0, 0],
                [1/6, -1/360, -11/36, -1/8, 1/2, 1/10, 0, 0],
                [1, -41/260, 22/13, 43/156, -118/39, 32/195, 80/39, 0],
                [1, 13/200, 0, 11/40, 11/40, 4/25, 4/25, 13/200]], dtype = myfloat)

# Hairer, 2nd edition (pg. 181)
verner_6 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/6, 0, 0, 0, 0, 0, 0, 0],
                [4/15, 4/75, 16/75, 0, 0, 0, 0, 0, 0],
                [2/3, 5/6, -8/3, 5/2, 0, 0, 0, 0, 0],
                [5/6, -165/64, 55/6, -425/64, 85/96, 0, 0, 0, 0],
                [1, 12/5, -8, 4015/612, -11/36, 88/255, 0, 0, 0],
                [1/15, -8263/15000, 124/75, -643/680, -81/250, 2484/10625, 0, 0, 0],
                [1, 3501/1720, -300/43, 297275/52632, -319/2322, 24068/84065, 0, 3850/26703, 0],
                [1, 3/40, 0, 875/2244, 23/72, 264/1955, 0, 125/11592, 43/616]], dtype = myfloat)
#--------------------------------------------------------------------------------------------------



# high-order (7-9)
#--------------------------------------------------------------------------------------------------
fehlberg_7 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [2/27, 2/27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/9, 1/36, 1/12, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/24, 0, 1/8, 0, 0, 0, 0, 0, 0, 0, 0],
                [5/12, 5/12, 0, -25/16, 25/16, 0, 0, 0, 0, 0, 0, 0],
                [1/2, 1/20, 0, 0, 1/4, 1/5, 0, 0, 0, 0, 0, 0],
                [5/6, -25/108, 0, 0, 125/108, -65/27, 125/54, 0, 0, 0, 0, 0],
                [1/6, 31/300, 0, 0, 0, 61/225, -2/9, 13/900, 0, 0, 0, 0],
                [2/3, 2, 0, 0, -53/6, 704/45, -107/9, 67/90, 3, 0, 0, 0],
                [1/3, -91/108, 0, 0, 23/108, -976/135, 311/54, -19/60, 17/6, -1/12, 0, 0],
                [1, 2383/4100, 0, 0, -341/164, 4496/1025, -301/82, 2133/4100, 45/82, 45/164, 18/41, 0],
                [1, 41/840, 0, 0, 0, 0, 34/105, 9/35, 9/35, 9/280, 9/280, 41/840]], dtype = myfloat)

curtis_8 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/192, 1/192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [7.4803184795467909e-02, -4.6236639493684439e-01, 5.3716957973231239e-01, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1.1220477719320186e-01, 2.8051194298300466e-02, 0, 8.4153582894901380e-02, 0, 0, 0, 0, 0, 0, 0, 0],
                [13/19, 8.1897867016409869, 0, -2.8775072279672202e+01, 2.1269496104347006e+01, 0, 0, 0, 0, 0, 0, 0],
                [1.7267316464601146e-01, 4.0374060815253993e-02, 0, 0, 1.3218823182231848e-01, 1.1087200843898359e-04, 0, 0, 0, 0, 0, 0],
                [8.2732683535398854e-01, 2.5873900305712910e-01, 0, 0, -1.0789704485967246, 3.4955683812996113e-01, 1.2980014427636228, 0, 0, 0, 0, 0],
                [1/2, 1.9559695938810262e-01, 0, 0, -7.7135514072989309e-01, 8.8677640841671346e-02, 1.0169692666685441, -2.9888726168424973e-02, 0, 0, 0, 0],
                [1.7267316464601146e-01, -5.6453739799316727e-03, 0, 0, 3.6664150851331873e-01, -4.7678144732965888e-02, -2.2046326596199767e-01, 1.3899990926683259e-02, 6.5918449880904728e-02, 0, 0, 0],
                [8.2732683535398854e-01, -1.6186994529880696, 0, 0, 8.4859361993123450, -1.6000746209745174, -1.6706963865871344e+01, 5.6707296863985979e-01, 2.6892514721246741, 9.0108041351110444, 0, 0],
                [1, 8.7651711673654731e-01, 0, 0, -4.1138940838927622, 4.7294741782224714e-01, 1.3785374631587118e+01, 2.8529348484093164e-02, -16/27, -9.7062986315222215, 2.4941679337757211e-01, 0],
                [1, 1/20, 0, 0, 0, 0, 13/180, 1/5, 16/45, 1/5, 13/180, 1/20]], dtype = myfloat)

shanks_8 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/9, 1/9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/24, 3/24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/4, 1/16, 0, 3/16, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/10, 29/500, 0, 33/500, -12/500, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 33/972, 0, 0, 4/972, 125/972, 0, 0, 0, 0, 0, 0, 0],
                [1/2, -21/36, 0, 0, 76/36, 125/36, -162/36, 0, 0, 0, 0, 0, 0],
                [2/3, -30/243, 0, 0, -32/243, 125/243, 0, 99/243, 0, 0, 0, 0, 0],
                [1/3, 1175/324, 0, 0, -3456/324, -6250/324, 8424/324, 242/324, -27/324, 0, 0, 0, 0],
                [5/6, 293/324, 0, 0, -852/324, -1375/324, 1836/324, -118/324, 162/324, 1, 0, 0, 0],
                [5/6, 1303/1620, 0, 0, -4260/1620, -6875/1620, 9990/1620, 1030/1620, 0, 0, 1/10, 0, 0],
                [1, -8595/4428, 0, 0, 30720/4428, 48750/4428, -66096/4428, 378/4428, -729/4428, -1944/4428, -1296/4428, 3240/4428, 0],
                [1, 41/840, 0, 0, 0, 0, 216/840, 272/840, 27/840, 27/840, 36/840, 180/840, 41/840]], dtype = myfloat)

# Shanks pseudo 8th order (10 stages)
shanks_pseudo_8 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0.14814814814814814, 0.14814814814814814, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [0.2222222222222222, 0.05555555555555555, 0.16666666666666666, 0, 0, 0, 0, 0, 0, 0, 0],
                [0.3333333333333333, 0.08333333333333333, 0, 0.25, 0, 0, 0, 0, 0, 0, 0],
                [0.5, 0.125, 0, 0, 0.375, 0, 0, 0, 0, 0, 0],
                [0.6666666666666666, 0.24074074074074073, 0, -0.5, 0.7777777777777778, 0.14814814814814814, 0, 0, 0, 0, 0],
                [0.16666666666666666, 0.09004629629629629, 0, -0.0125, 0.22361111111111112, -0.19074074074074074, 0.05625, 0, 0, 0, 0],
                [1, -11.55, 0, 4.05, -58.2, 32.8, -6.1, 40, 0, 0, 0],
                [0.8333333333333334, -0.4409722222222222, 0, 0.0625, -2.3541666666666665, 1.5833333333333333, -0.03125, 2, 0.013888888888888888, 0, 0],
                [1, 1.8060975609756098, 0, -0.09878048780487805, 8.663414634146342, -4.117073170731707, 0.08780487804878048, -6.146341463414634, -0.07317073170731707, 0.8780487804878049, 0],
                [1, 0.04880952380952381, 0, 0, 0.03214285714285714, 0.3238095238095238, 0.03214285714285714, 0.2571428571428571, 0, 0.2571428571428571,  0.04880952380952381]], dtype = myfloat)

# Hairer 1st edition (pg. )
dormand_prince_8 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/18, 1/18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/12, 1/48, 1/16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/8, 1/32, 0, 3/32, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [5/16, 5/16, 0, -75/64, 75/64, 0, 0, 0, 0, 0, 0, 0, 0],
                [3/8, 3/80, 0, 0, 3/16, 3/20, 0, 0, 0, 0, 0, 0, 0],
                [59/400, 29443841/614563906, 0, 0, 77736538/692538347, -28693883/1125000000, 23124283/1800000000, 0, 0, 0, 0, 0, 0],
                [93/200, 16016141/946692911, 0, 0, 61564180/158732637, 22789713/633445777, 545815736/2771057229, -180193667/1043307555, 0, 0, 0, 0, 0],
                [5490023248/9719169821, 39632708/573591083, 0, 0, -433636366/683701615, -421739975/2616292301, 100302831/723423059, 790204164/839813087, 800635310/3783071287, 0, 0, 0, 0],
                [13/20, 246121993/1340847787, 0, 0, -37695042795/15268766246, -309121744/1061227803, -12992083/490766935, 6005943493/2108947869, 393006217/1396673457, 123872331/1001029789, 0, 0, 0],
                [1201146811/1299019798, -1028468189/846180014, 0, 0, 8478235783/508512852, 1311729495/1432422823, -10304129995/1701304382, -48777925059/3047939560, 15336726248/1032824649, -45442868181/3398467696, 3065993473/597172653, 0, 0],
                [1, 185892177/718116043, 0, 0, -3185094517/667107341, -477755414/1098053517, -703635378/230739211, 5731566787/1027545527, 5232866602/850066563, -4093664535/808688257, 3962137247/1805957418, 65686358/487910083, 0],
                [1, 13451932/455176623, 0, 0, 0, 0, -808719846/976000145, 1757004468/5645159321, 656045339/265891186, -3867574721/1518517206, 465885868/322736535,  53011238/667516719, 2/45]], dtype=myfloat)
#--------------------------------------------------------------------------------------------------



# very high order (10+), undo word wrap
#--------------------------------------------------------------------------------------------------
feagin_10 = np.array([
                [0.,                                           0.,                                           0.,                                          0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [1./10.,                                       1./10.,                                       0.,                                          0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [53935784080298178753./100000000000000000000., -22879414034382286013./25000000000000000000., 29090688043565464561./20000000000000000000., 0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [8090367612044726813./10000000000000000000.,   2528239878763977129./12500000000000000000.,   0.,                                          60677757090335451097./100000000000000000000.,  0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [3090367612044726813./10000000000000000000.,   3680494294172871503./20000000000000000000.,   0.,                                          19796683122719236907./100000000000000000000.,  -1823869618284081573./25000000000000000000., 0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [3924296760879181073./4000000000000000000.,    8790073402066813373./100000000000000000000.,  0.,                                          0.,                                            10261492563006516133./25000000000000000000., 1206784384197166223./2500000000000000000.,    0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [83333333333333333333./100000000000000000000., 4298502524512301511./50000000000000000000.,   0.,                                          0.,                                            6617719260814443679./20000000000000000000.,  12241573932736254821./25000000000000000000.,  -914820468838563421./12500000000000000000.,    0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [35401736585680237633./100000000000000000000., 6046522456266686033./50000000000000000000.,   0.,                                          0.,                                            0.,                                          26012467575829562281./100000000000000000000., 1627013107745456651./50000000000000000000.,    -186181316192925313./3125000000000000000.,     0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [88252766196473234643./100000000000000000000., 11085437958039148351./100000000000000000000., 0.,                                          0.,                                            0.,                                          0.,                                           -1514403720637513969./25000000000000000000.,   3217637056017783901./10000000000000000000.,    25524286280403151579./50000000000000000000.,   0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [2008174244501007963./3125000000000000000.,    11205441475287900483./100000000000000000000., 0.,                                          0.,                                            0.,                                          0.,                                           -14494277590286591567./100000000000000000000., -33326971909625670659./100000000000000000000., 9985384591137601227./20000000000000000000.,    6368807611621076303./12500000000000000000.,   0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [1116825755498992037./3125000000000000000.,    5698839198209299307./50000000000000000000.,   0.,                                          0.,                                            0.,                                          0.,                                           -3844066821016784693./50000000000000000000.,   23952736032439064911./100000000000000000000.,  7955493247361892781./20000000000000000000.,    268897392184018639./25000000000000000000.,    -6555382483280377483./20000000000000000000.,    0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [11747233803526765357./100000000000000000000., 498946580175122529./6250000000000000000.,     0.,                                          0.,                                            0.,                                          0.,                                           -1040659373601206153./20000000000000000000.,   -5769541461685488817./100000000000000000000.,  9739095785605208249./50000000000000000000.,    14538492318832506973./100000000000000000000., -122334798492448559./1562500000000000000.,      -5725164968054945609./50000000000000000000.,    0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [83333333333333333333./100000000000000000000., 24627890254121432003./25000000000000000000.,  0.,                                          0.,                                            6617719260814443679./20000000000000000000.,  12241573932736254821./25000000000000000000.,  -68948243287421783791./50000000000000000000.,  -86116419502763566667./100000000000000000000., 578428813637537220023./100000000000000000000., 32880776198510356689./10000000000000000000.,  -238633905093136384013./100000000000000000000., -65095868496728783731./20000000000000000000.,   -108171770843211491177./50000000000000000000., 0.,                                           0.,                                            0.,                                           0.,       0.],
                [3090367612044726813./10000000000000000000.,   17901605915432657821./20000000000000000000.,  0.,                                          19796683122719236907./100000000000000000000.,  -1823869618284081573./25000000000000000000., 0.,                                           -42561811983100380987./50000000000000000000.,  9958002807963332543./25000000000000000000.,    363937263181035606029./100000000000000000000., 30964575407966064473./20000000000000000000.,  -106110857352026858013./50000000000000000000.,  -158350398545326172713./100000000000000000000., -85780804142968132461./50000000000000000000.,  -2440364057501274521./100000000000000000000., 0.,                                            0.,                                           0.,       0.],
                [53935784080298178753./100000000000000000000., -22879414034382286013./25000000000000000000., 29090688043565464561./20000000000000000000., 0.,                                            0.,                                          -38866682182248411677./50000000000000000000., 0.,                                            -1138619577693970087./12500000000000000000.,   0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            1138619577693970087./12500000000000000000.,   38866682182248411677./50000000000000000000.,   0.,                                           0.,       0.],
                [1./10.,                                       1./10.,                                       0.,                                          -15717866579977116337./100000000000000000000., 0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            15717866579977116337./100000000000000000000., 0.,       0.],
                [1./1.,                                        18178130070009528389./100000000000000000000., 27./40.,                                     17137907992359491997./50000000000000000000.,   0.,                                          25911121454832274451./100000000000000000000., -7165579334359041781./20000000000000000000.,   -20918979188176661219./20000000000000000000.,  93032784541562698329./100000000000000000000.,  88975479715854051223./50000000000000000000.,  1./10.,                                         -28254756953904408161./100000000000000000000.,  -15932735011997254917./100000000000000000000., -7275794732350075543./50000000000000000000.,  -25911121454832274451./100000000000000000000., -17137907992359491997./50000000000000000000., -27./40., 0.],
                [1, 3333333333333333333./100000000000000000000., 1./40., 3333333333333333333./100000000000000000000., 0., 1./20., 0., 1./25., 0., 2365468476861543627./12500000000000000000., 27742918851774317651./100000000000000000000., 27742918851774317651./100000000000000000000., 2365468476861543627./12500000000000000000., -1./25., -1./20., -3333333333333333333./100000000000000000000., -1./40., 3333333333333333333./100000000000000000000.]], dtype = myfloat)

# undo word wrap
feagin_14 = np.array([
                [0.,                                     0.,                                         0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [11111111111111111./100000000000000000., 11111111111111111./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [13888888888888889./25000000000000000.,  -83333333333333333./100000000000000000.,    138888888888888889./100000000000000000., 0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [83333333333333333./100000000000000000., 20833333333333333./100000000000000000.,     0.,                                      5./8.,                                  0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [33333333333333333./100000000000000000., 19333333333333333./100000000000000000.,     0.,                                      11./50.,                                -2./25.,                              0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [1./1.,                                  1./10.,                                     0.,                                      0.,                                     2./5.,                                1./2.,                                 0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16749674481819323./25000000000000000.,  5174228081833989./50000000000000000.,       0.,                                      0.,                                     6103444365320361./50000000000000000., 24128724516562331./50000000000000000., -381409600015607./10000000000000000.,  0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [7426709605345459./25000000000000000.,   12438052665409441./100000000000000000.,     0.,                                      0.,                                     0.,                                   2261202821975843./10000000000000000.,  1378858876180809./100000000000000000., -1680525334991711./25000000000000000.,  0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [72727272727272727./100000000000000000., 4684595328298369./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    -613406843450511./100000000000000000., 10800991281275153./50000000000000000.,  21184753175788097./50000000000000000.,  0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [14015279904218877./100000000000000000., 8384798124090527./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    -589746835504869./50000000000000000.,  -4945980411376253./20000000000000000.,  978080858367729./10000000000000000.,    21759068924342063./100000000000000000.,  0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [35035051988507537./50000000000000000.,  3076276798847141./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    592232780324503./100000000000000000.,  47032615996384111./100000000000000000., 299688863848679./1000000000000000.,     -24765687759399491./100000000000000000., 1386187872142971./12500000000000000.,    0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9090909090909091./25000000000000000.,   2098500366813913./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    -63597539253241./20000000000000000.,   10079971436327401./12500000000000000.,  975983126412389./10000000000000000.,    77857557815839891./100000000000000000.,  20489042383159943./100000000000000000.,  -39065394906867047./25000000000000000.,   0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [26315789473684211./100000000000000000., 2188633911168651./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     124873005504039./20000000000000000.,     20004309710957731./100000000000000000.,  -805328367804983./100000000000000000.,    423035056134793./20000000000000000.,    0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [3921722466502709./100000000000000000.,  1417496251817573./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     249163204855817./100000000000000000.,    2301387878545931./100000000000000000.,   -322155956692977./100000000000000000.,    197688509889533./20000000000000000.,    -1065053856644437./50000000000000000.,      0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [20322937573209419./25000000000000000.,  343511894290243./1000000000000000.,         0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     21045191202362739./100000000000000000.,  25856863014307603./25000000000000000.,   300151822932211./50000000000000000.,      42796906254980977./50000000000000000.,  -97723500503676681./100000000000000000.,    -66002698047929469./100000000000000000.,    0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16666666666666667./100000000000000000., -1435740016721681./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -4578165875613./125000000000000.,        3502549756362137./100000000000000000.,   721892032724227./20000000000000000.,      -2652199675536811./100000000000000000., 4456990113056981./100000000000000000.,      777144333320989./6250000000000000.,         413829693239481./100000000000000000.,     0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9./10.,                                 35603240442512029./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -2250963794737813./5000000000000000.,    4305279070837109./10000000000000000.,    3199831431318889./6250000000000000.,      45415181944320213./50000000000000000.,  -30980273342983483./25000000000000000.,     -64904866167176147./100000000000000000.,    25170890458681929./100000000000000000.,   974883087931983./1250000000000000.,        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [6412992574519669./100000000000000000.,  1309356874065131./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -9320530679851./100000000000000000.,        2526871671311497./50000000000000000.,       40223517097./50000000000000000.,          59172602949417./100000000000000000.,       -8032294443./20000000000000000.,         0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [4082998185668577./20000000000000000.,   207926484466053./10000000000000000.,        0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     58269591880009./100000000000000000.,        -25053147886213./3125000000000000.,         403847643847./100000000000000000.,        8546099980555061./100000000000000000.,     -25560810117./12500000000000000.,        10532857882443189./100000000000000000.,    0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [39535039104876057./100000000000000000., 140153449795736021./100000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -11512600049211063./50000000000000000.,     -360553420233456453./50000000000000000.,    93225390173709./25000000000000000.,       -471415495727125021./100000000000000000.,  -176367657545349./100000000000000000.,   382065274019349383./50000000000000000.,    70120408731950367./20000000000000000.,    0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [60464960895123943./100000000000000000., 298786626735301717./25000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     779480932108175969./100000000000000000.,    -225800557546930317./4000000000000000.,     9123763069306449./100000000000000000.,    -636681399627174431./50000000000000000.,   -3968959219047197./100000000000000000.,  544392141883570887./10000000000000000.,    -364411637921569237./100000000000000000., -80450324991050991./100000000000000000., 0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [15917001814331423./20000000000000000.,  -14880942650710048843./100000000000000000., 0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -2293238195728141211./25000000000000000.,   70765614497159835983./100000000000000000.,  -110563611857482441./100000000000000000., 17613459188381137259./100000000000000000., 24569241210744033./50000000000000000.,   -17106950011245373609./25000000000000000., 279910604998398259./10000000000000000.,   659698550151411667./50000000000000000.,  25025756256796089./20000000000000000.,   0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [93587007425480331./100000000000000000., -241826986737049191./25000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -446990150858505531./100000000000000000.,   227563564345476341./5000000000000000.,      -7130850861838269./100000000000000000.,   140342017585515927./12500000000000000.,    394513677242571./3125000000000000.,      -272149587218427071./6250000000000000.,    39358715377152949./50000000000000000.,    26613234837234211./50000000000000000.,   42242273399632533./100000000000000000.,  8591312495030671./100000000000000000.,   0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16666666666666667./100000000000000000., -62915020279409189./6250000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -4578165875613./125000000000000.,        3502549756362137./100000000000000000.,   721892032724227./20000000000000000.,      -2652199675536811./100000000000000000., -39193060761341509./6250000000000000.,      4820792374425629891./100000000000000000.,   -868089611420207./12500000000000000.,     1268106902048502957./100000000000000000.,  598355844841619./50000000000000000.,     -58406220624060301./1250000000000000.,     133029613326626711./100000000000000000.,  50383393751699149./50000000000000000.,   2095120519336651./100000000000000000.,   1050673531656321./50000000000000000.,    476098007208561./50000000000000000.,   0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [20322937573209419./25000000000000000.,  -40947808167774370877./100000000000000000., 0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     21045191202362739./100000000000000000.,  25856863014307603./25000000000000000.,   300151822932211./50000000000000000.,      42796906254980977./50000000000000000.,  -25051699854744786049./100000000000000000., 97321233326194213883./50000000000000000.,   -152251941051155183./50000000000000000.,  6132829744103521419./12500000000000000.,   156647589531270907./100000000000000000., -94098714497005586681./50000000000000000., 7525922247248471753./100000000000000000., 864335892450827669./25000000000000000.,  321147679440968961./100000000000000000., -46040804173841439./100000000000000000., -1741436679683621./20000000000000000., -184837953539575767./25000000000000000.,  0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [3921722466502709./100000000000000000.,  343347475853550879./100000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     249163204855817./100000000000000000.,    2301387878545931./100000000000000000.,   -322155956692977./100000000000000000.,    197688509889533./20000000000000000.,    54063199844480627./25000000000000000.,      -1626998645464574213./100000000000000000.,  -2570690042410491./20000000000000000.,    -898915042666504253./100000000000000000.,  -13943814529281./4000000000000000.,      63174477645335923./4000000000000000.,      -57440333091409507./100000000000000000.,  -3456020390213933./10000000000000000.,   -132448298041317./20000000000000000.,    -194447032310551./25000000000000000.,    -14243367696091./4000000000000000.,    1198206266124827./250000000000000.,       7686273243653429./50000000000000000.,    0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9090909090909091./25000000000000000.,   3230385208719854423./100000000000000000.,   0.,                                      0.,                                     0.,                                   0.,                                    -63597539253241./20000000000000000.,   10079971436327401./12500000000000000.,  975983126412389./10000000000000000.,    77857557815839891./100000000000000000.,  20489042383159943./100000000000000000.,  -39065394906867047./25000000000000000.,   0.,                                     817149459411552853./50000000000000000.,     -15454455529354362123./100000000000000000., 156971088703334873./100000000000000000.,  327685545087248131./100000000000000000.,   -1258723112984133./25000000000000000.,   15332115185804166507./100000000000000000., 44848011645482531./6250000000000000.,     -147018374337650241./50000000000000000., -6658459460768031./100000000000000000.,  -4623460549908437./100000000000000000.,  -1020993667928397./50000000000000000., -1067046212877471701./20000000000000000., -27109742943015731./20000000000000000.,  -9824767237577047./6250000000000000.,     0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [35035051988507537./50000000000000000.,  -1664514674863415129./100000000000000000.,  0.,                                      0.,                                     0.,                                   0.,                                    592232780324503./100000000000000000.,  47032615996384111./100000000000000000., 299688863848679./1000000000000000.,     -24765687759399491./100000000000000000., 1386187872142971./12500000000000000.,    0.,                                       -9834380876924583./20000000000000000.,  -114743154427289497./10000000000000000.,    321037266630492109./4000000000000000.,      -7682646079600857./20000000000000000.,    728147667468107583./100000000000000000.,   -6634969230612419./50000000000000000.,   -8107998325257307267./100000000000000000., -781484330222629./625000000000000.,       259263594969543681./100000000000000000., -15072014917320227./50000000000000000.,  11069223039491617./50000000000000000.,   8275772747718929./100000000000000000., 379921324081223041./20000000000000000.,   26923194640963969./100000000000000000.,  162674827447066537./100000000000000000.,  9834380876924583./20000000000000000.,    0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [14015279904218877./100000000000000000., 8384798124090527./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    -589746835504869./50000000000000000.,  -4945980411376253./20000000000000000.,  978080858367729./10000000000000000.,    21759068924342063./100000000000000000.,  0.,                                      6879280338166261./50000000000000000.,     4398702297150467./100000000000000000.,  0.,                                         -25685040688409667./50000000000000000.,     82635569115131551./100000000000000000.,   1285090698599059163./50000000000000000.,   0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    -1285090698599059163./50000000000000000., -82635569115131551./100000000000000000., 25685040688409667./50000000000000000.,    -4398702297150467./100000000000000000.,  -6879280338166261./50000000000000000.,    0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [7426709605345459./25000000000000000.,   12438052665409441./100000000000000000.,     0.,                                      0.,                                     0.,                                   2261202821975843./10000000000000000.,  1378858876180809./100000000000000000., -1680525334991711./25000000000000000.,  0.,                                     0.,                                      -17124779501708567./20000000000000000.,  -196337522866858909./100000000000000000., -1161664113620597./5000000000000000.,   0.,                                         430660719086453349./100000000000000000.,    -292722963249465483./100000000000000000., -1646263332795717889./20000000000000000.,  0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    1646263332795717889./20000000000000000.,  292722963249465483./100000000000000000., -430660719086453349./100000000000000000., 1161664113620597./5000000000000000.,     196337522866858909./100000000000000000.,  17124779501708567./20000000000000000.,  0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16749674481819323./25000000000000000.,  5174228081833989./50000000000000000.,       0.,                                      0.,                                     6103444365320361./50000000000000000., 24128724516562331./50000000000000000., -381409600015607./10000000000000000.,  0.,                                     -6881244066385029./12500000000000000.,  0.,                                      -71191581158518923./100000000000000000., -29206480283577567./50000000000000000.,   0.,                                     0.,                                         52761577031466233./25000000000000000.,      -8374947367395721./100000000000000000.,   255010749536160457./50000000000000000.,    0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    -255010749536160457./50000000000000000.,  8374947367395721./100000000000000000.,   -52761577031466233./25000000000000000.,   0.,                                      29206480283577567./50000000000000000.,    71191581158518923./100000000000000000., 6881244066385029./12500000000000000.,    0.,                                     0.,        0.,                                    0.,                                      0.],
                [33333333333333333./100000000000000000., 19333333333333333./100000000000000000.,     0.,                                      11./50.,                                -2./25.,                              0.,                                    0.,                                    1099934255807247./10000000000000000.,   -3178713100953377./12500000000000000.,  0.,                                      3462283108466777./4000000000000000.,     332416449114093083./100000000000000000.,  0.,                                     0.,                                         -1201022233159779339./100000000000000000.,  11915036656062331./25000000000000000.,    -580486022442072781./20000000000000000.,   0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    580486022442072781./20000000000000000.,   -11915036656062331./25000000000000000.,  1201022233159779339./100000000000000000., 0.,                                      -332416449114093083./100000000000000000., -3462283108466777./4000000000000000.,   3178713100953377./12500000000000000.,    -1099934255807247./10000000000000000.,  0.,        0.,                                    0.,                                      0.],
                [13888888888888889./25000000000000000.,  -83333333333333333./100000000000000000.,    138888888888888889./100000000000000000., 0.,                                     0.,                                   -3./4.,                                0.,                                    -4925295437180263./10000000000000000.,  0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      4925295437180263./10000000000000000.,   3./4.,     0.,                                    0.,                                      0.],
                [11111111111111111./100000000000000000., 11111111111111111./100000000000000000.,     0.,                                      -11111111111111111./50000000000000000., 0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        11111111111111111./50000000000000000., 0.,                                      0.],
                [1./1.,                                  7145878509724289./25000000000000000.,       29166666666666667./100000000000000000.,  7./32.,                                 0.,                                   21./128.,                              0.,                                    10909717747277833./50000000000000000.,  18039289847869777./100000000000000000., 0.,                                      10285691970242251./50000000000000000.,   94810856086629./390625000000000.,         24646578081362931./100000000000000000., -13799677631635633./4000000000000000.,      2860944527000451./12500000000000000.,       14164529985107571./50000000000000000.,    321085125837766641./100000000000000000.,   -2235387773648457./10000000000000000.,   -70712115720441907./100000000000000000.,   8028083628757177./2500000000000000.,      70477174154834883./50000000000000000.,   -15136205344374261./100000000000000000., 9308764363175357./25000000000000000.,    12648937320318067./50000000000000000., -321085125837766641./100000000000000000., -14164529985107571./50000000000000000.,  -2860944527000451./12500000000000000.,    -24646578081362931./100000000000000000., -94810856086629./390625000000000.,        -10285691970242251./50000000000000000., -18039289847869777./100000000000000000., -10909717747277833./50000000000000000., -21./128., -7./32.,                               -29166666666666667./100000000000000000., 0.],
                [1, 892857142857143./50000000000000000., 3./512., 3./256., 0., 9./512., 0., 3./128., 15./512., 0., 9./256., 21./512., 3./64., 0., 27./512., 15./256., 33./512., 0., 5267605678587651./50000000000000000., 8528067312087609./50000000000000000., 10311469866467597./50000000000000000., 10311469866467597./50000000000000000., 8528067312087609./50000000000000000., 5267605678587651./50000000000000000., -33./512., -15./256., -27./512., -3./64., -21./512., -9./256., -15./512., -3./128., -9./512., -3./256., -3./512., 892857142857143./50000000000000000.]], dtype = myfloat)
#--------------------------------------------------------------------------------------------------





# embedded RK methods (explicit):


# low order (1-3)
#--------------------------------------------------------------------------------------------------
fehlberg_1_2 = np.array([
                [0, 0, 0, 0],
                [1/2, 1/2, 0, 0],
                [1, 1/256, 255/256, 0],
                [1, 1/256, 255/256, 0],
                [1, 1/512, 255/256, 1/512]], dtype = myfloat)

heun_euler_2_1 = np.array([
                [0, 0, 0],
                [1, 1, 0],
                [1, 1/2, 1/2],
                [1, 1, 0]], dtype = myfloat)

bogacki_shampine_3_2 = np.array([
                [0, 0, 0, 0, 0],
                [1/2, 1/2, 0, 0, 0],
                [3/4, 0, 3/4, 0, 0],
                [1, 2/9, 1/3, 4/9, 0],
                [1, 2/9, 1/3, 4/9, 0],
                [1, 7/24, 1/4, 1/3, 1/8]], dtype = myfloat)
#--------------------------------------------------------------------------------------------------



# mid order (4-6)
#--------------------------------------------------------------------------------------------------
fehlberg_4_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/4, 1/4, 0, 0, 0, 0, 0],
                [3/8, 3/32, 9/32, 0, 0, 0, 0],
                [12/13, 1932/2197, -7200/2197, 7296/2197, 0, 0, 0],
                [1, 439/216, -8, 3680/513, -845/4104, 0, 0],
                [1/2, -8/27, 2, -3544/2565, 1859/4104, -11/40, 0],
                [1, 25/216, 0, 1408/2565, 2197/4104, -1/5, 0],
                [1, 16/135, 0, 6656/12825, 28561/56430, -9/50, 2/55]], dtype = myfloat)

cash_karp_5_4 = np.array([
                [0, 0, 0, 0, 0, 0, 0],
                [1/5, 1/5, 0, 0, 0, 0, 0],
                [3/10, 3/40, 9/40, 0, 0, 0, 0],
                [3/5, 3/10, -9/10, 6/5, 0, 0, 0],
                [1, -11/54, 5/2, -70/27, 35/27, 0, 0],
                [7/8, 1631/55296, 175/512, 575/13824, 44275/110592, 253/4096, 0],
                [1, 37/378, 0, 250/621, 125/594, 0, 512/1771],
                [1, 2825/27648, 0, 18575/48384, 13525/55296, 277/14336, 1/4]], dtype = myfloat)


dormand_prince_5_4 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0],
                [1/5, 1/5, 0, 0, 0, 0, 0, 0],
                [3/10, 3/40, 9/40, 0, 0, 0, 0, 0],
                [4/5, 44/45, -56/15, 32/9, 0, 0, 0, 0],
                [8/9, 19372/6561, -25360/2187, 64448/6561, -212/729, 0, 0, 0],
                [1, 9017/3168, -355/33, 46732/5247, 49/176, -5103/18656, 0, 0],
                [1, 35/384, 0, 500/1113, 125/192, -2187/6784, 11/84, 0],
                [1, 35/384, 0, 500/1113, 125/192, -2187/6784, 11/84, 0],
                [1, 5179/57600, 0, 7571/16695, 393/640, -92097/339200, 187/2100, 1/40]], dtype = myfloat)

bogacki_shampine_5_4 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/6, 0, 0, 0, 0, 0, 0],
                [2/9, 2/27, 4/27, 0, 0, 0, 0, 0],
                [3/7, 183/1372, -162/343, 1053/1372, 0, 0, 0, 0],
                [2/3, 68/297, -4/11, 42/143, 1960/3861, 0, 0, 0],
                [3/4, 597/22528, 81/352, 63099/585728, 58653/366080, 4617/20480, 0, 0],
                [1, 174197/959244, -30942/79937, 8152137/19744439, 666106/1039181, -29421/29068, 482048/414219, 0],
                [1, 587/8064, 0, 4440339/15491840, 24353/124800, 387/44800, 2152/5985, 7267/94080],
                [1, 6059/80640, 0, 8559189/30983680, 26411/124800, -927/89600, 443/1197, 7267/94080]], dtype = myfloat)

tsitouras_5_4 = np.array([
                  [0, 0, 0, 0, 0, 0, 0, 0],
                  [0.161, 0.161, 0, 0, 0, 0, 0, 0],
                  [0.327, -8.4806554923569887e-03, 3.3548065549235700e-01, 0, 0, 0, 0, 0],
                  [0.9, 2.8971530571054935, -6.3594484899750752, 4.3622954328695815, 0, 0, 0, 0],
                  [9.8002554090450966e-01, 5.3258648284392569, -1.1748883564062828e+01, 7.4955393428898365, -9.2495066361755252e-02, 0, 0, 0],
                  [1, 5.8614554429464203, -1.2920969317847110e+01, 8.1593678985761589, -7.1584973281400996e-02, -2.8269050394068383e-02, 0, 0],
                  [1, 9.6460766818065230e-02, 0.01, 4.7988965041449960e-01, 1.3790085741037419, -3.2900695154360808, 2.3247105240997739, 0],
                  [1, 9.6460766818065230e-02, 0.01, 4.7988965041449960e-01, 1.3790085741037419, -3.2900695154360808, 2.3247105240997739, 0],
                  [1, 9.4680755765839453e-02, 9.1835655403432540e-03, 4.8777052842476160e-01, 1.2342975669304790, -2.7077123499835256, 1.8666284181705870, 1/66]], dtype = myfloat)

# from Verner 1978 paper
verner_5_6 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/18, 1/18, 0, 0, 0, 0, 0, 0, 0],
                [1/6, -1/12, 1/4, 0, 0, 0, 0, 0, 0],
                [2/9, -2/81, 4/27, 8/81, 0, 0, 0, 0, 0],
                [2/3, 40/33, -4/11, -56/11, 54/11, 0, 0, 0, 0],
                [1, -369/73, 72/73, 5380/219, -12285/584, 2695/1752, 0, 0, 0],
                [8/9, -8716/891, 656/297, 39520/891, -416/11, 52/27, 0, 0, 0],
                [1, 3015/256, -9/4, -4219/78, 5985/128, -539/384, 0, 693/3328, 0],
                [1, 3/80, 0, 4/25, 243/1120, 77/160, 73/700, 0, 0],
                [1, 57/640, 0, -16/65, 1377/2240, 121/320, 0, 891/8320, 2/35]], dtype = myfloat)

# from Hairer
verner_6_5 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/6, 0, 0, 0, 0, 0, 0, 0],
                [4/15, 4/75, 16/75, 0, 0, 0, 0, 0, 0],
                [2/3, 5/6, -8/3, 5/2, 0, 0, 0, 0, 0],
                [5/6, -165/64, 55/6, -425/64, 85/96, 0, 0, 0, 0],
                [1, 12/5, -8, 4015/612, -11/36, 88/255, 0, 0, 0],
                [1/15, -8263/15000, 124/75, -643/680, -81/250, 2484/10625, 0, 0, 0],
                [1, 3501/1720, -300/43, 297275/52632, -319/2322, 24068/84065, 0, 3850/26703, 0],
                [1, 3/40, 0, 875/2244, 23/72, 264/1955, 0, 125/11592, 43/616],
                [1, 13/160, 0, 2375/5984, 5/16, 12/85, 3/44, 0, 0]], dtype = myfloat)


fehlberg_7_8 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [2/27, 2/27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/9, 1/36, 1/12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 1/24, 0, 1/8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [5/12, 5/12, 0, -25/16, 25/16, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/2, 1/20, 0, 0, 1/4, 1/5, 0, 0, 0, 0, 0, 0, 0, 0],
                [5/6, -25/108, 0, 0, 125/108, -65/27, 125/54, 0, 0, 0, 0, 0, 0, 0],
                [1/6, 31/300, 0, 0, 0, 61/225, -2/9, 13/900, 0, 0, 0, 0, 0, 0],
                [2/3, 2, 0, 0, -53/6, 704/45, -107/9, 67/90, 3, 0, 0, 0, 0, 0],
                [1/3, -91/108, 0, 0, 23/108, -976/135, 311/54, -19/60, 17/6, -1/12, 0, 0, 0, 0],
                [1, 2383/4100, 0, 0, -341/164, 4496/1025, -301/82, 2133/4100, 45/82, 45/164, 18/41, 0, 0, 0],
                [0, 3/205, 0, 0, 0, 0, -6/41, -3/205, -3/41, 3/41, 6/41, 0, 0, 0],
                [1, -1777/4100, 0, 0, -341/164, 4496/1025, -289/82, 2193/4100, 51/82, 33/164, 12/41, 0, 1, 0],
                [1, 41/840, 0, 0, 0, 0, 34/105, 9/35, 9/35, 9/280, 9/280, 41/840, 0, 0],
                [1, 0, 0, 0, 0, 0, 34/105, 9/35, 9/35, 9/280, 9/280, 0, 41/840, 41/840]], dtype = myfloat)


dormand_prince_8_7 = np.array([
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/18, 1/18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/12, 1/48, 1/16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [1/8, 1/32, 0, 3/32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [5/16, 5/16, 0, -75/64, 75/64, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                [3/8, 3/80, 0, 0, 3/16, 3/20, 0, 0, 0, 0, 0, 0, 0, 0],
                [59/400, 29443841/614563906, 0, 0, 77736538/692538347, -28693883/1125000000, 23124283/1800000000, 0, 0, 0, 0, 0, 0, 0],
                [93/200, 16016141/946692911, 0, 0, 61564180/158732637, 22789713/633445777, 545815736/2771057229, -180193667/1043307555, 0, 0, 0, 0, 0, 0],
                [5490023248/9719169821, 39632708/573591083, 0, 0, -433636366/683701615, -421739975/2616292301, 100302831/723423059, 790204164/839813087, 800635310/3783071287, 0, 0, 0, 0, 0],
                [13/20, 246121993/1340847787, 0, 0, -37695042795/15268766246, -309121744/1061227803, -12992083/490766935, 6005943493/2108947869, 393006217/1396673457, 123872331/1001029789, 0, 0, 0, 0],
                [1201146811/1299019798, -1028468189/846180014, 0, 0, 8478235783/508512852, 1311729495/1432422823, -10304129995/1701304382, -48777925059/3047939560, 15336726248/1032824649, -45442868181/3398467696, 3065993473/597172653, 0, 0, 0],
                [1, 185892177/718116043, 0, 0, -3185094517/667107341, -477755414/1098053517, -703635378/230739211, 5731566787/1027545527, 5232866602/850066563, -4093664535/808688257, 3962137247/1805957418, 65686358/487910083, 0, 0],
                [1, 403863854/491063109, 0, 0, -5068492393/434740067, -411421997/543043805, 652783627/914296604, 11173962825/925320556, -13158990841/6184727034, 3936647629/1978049680, -160528059/685178525, 248638103/1413531060, 0, 0],
                [1, 13451932/455176623, 0, 0, 0, 0, -808719846/976000145, 1757004468/5645159321, 656045339/265891186, -3867574721/1518517206, 465885868/322736535,  53011238/667516719, 2/45, 0],
                [1, 14005451/335480064, 0, 0, 0, 0, -59238493/1068277825, 181606767/758867731, 561292985/797845732, -1041891430/1371343529, 760417239/1151165299, 118820643/751138087, -528747749/2220607170, 1/4]], dtype=myfloat)


# todo: find automated way to include these possibilities (take embedded method, option variable: free = None, 1, 2)

# dormand_prince_8_1 = np.array([
#                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/18, 1/18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/12, 1/48, 1/16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/8, 1/32, 0, 3/32, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [5/16, 5/16, 0, -75/64, 75/64, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [3/8, 3/80, 0, 0, 3/16, 3/20, 0, 0, 0, 0, 0, 0, 0],
#                 [59/400, 29443841/614563906, 0, 0, 77736538/692538347, -28693883/1125000000, 23124283/1800000000, 0, 0, 0, 0, 0, 0],
#                 [93/200, 16016141/946692911, 0, 0, 61564180/158732637, 22789713/633445777, 545815736/2771057229, -180193667/1043307555, 0, 0, 0, 0, 0],
#                 [5490023248/9719169821, 39632708/573591083, 0, 0, -433636366/683701615, -421739975/2616292301, 100302831/723423059, 790204164/839813087, 800635310/3783071287, 0, 0, 0, 0],
#                 [13/20, 246121993/1340847787, 0, 0, -37695042795/15268766246, -309121744/1061227803, -12992083/490766935, 6005943493/2108947869, 393006217/1396673457, 123872331/1001029789, 0, 0, 0],
#                 [1201146811/1299019798, -1028468189/846180014, 0, 0, 8478235783/508512852, 1311729495/1432422823, -10304129995/1701304382, -48777925059/3047939560, 15336726248/1032824649, -45442868181/3398467696, 3065993473/597172653, 0, 0],
#                 [1, 185892177/718116043, 0, 0, -3185094517/667107341, -477755414/1098053517, -703635378/230739211, 5731566787/1027545527, 5232866602/850066563, -4093664535/808688257, 3962137247/1805957418, 65686358/487910083, 0],
#                 [1, 13451932/455176623, 0, 0, 0, 0, -808719846/976000145, 1757004468/5645159321, 656045339/265891186, -3867574721/1518517206, 465885868/322736535,  53011238/667516719, 2/45],
#                 [1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], dtype=myfloat)


# dormand_prince_8_2 = np.array([
#                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/18, 1/18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/12, 1/48, 1/16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [1/8, 1/32, 0, 3/32, 0, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [5/16, 5/16, 0, -75/64, 75/64, 0, 0, 0, 0, 0, 0, 0, 0],
#                 [3/8, 3/80, 0, 0, 3/16, 3/20, 0, 0, 0, 0, 0, 0, 0],
#                 [59/400, 29443841/614563906, 0, 0, 77736538/692538347, -28693883/1125000000, 23124283/1800000000, 0, 0, 0, 0, 0, 0],
#                 [93/200, 16016141/946692911, 0, 0, 61564180/158732637, 22789713/633445777, 545815736/2771057229, -180193667/1043307555, 0, 0, 0, 0, 0],
#                 [5490023248/9719169821, 39632708/573591083, 0, 0, -433636366/683701615, -421739975/2616292301, 100302831/723423059, 790204164/839813087, 800635310/3783071287, 0, 0, 0, 0],
#                 [13/20, 246121993/1340847787, 0, 0, -37695042795/15268766246, -309121744/1061227803, -12992083/490766935, 6005943493/2108947869, 393006217/1396673457, 123872331/1001029789, 0, 0, 0],
#                 [1201146811/1299019798, -1028468189/846180014, 0, 0, 8478235783/508512852, 1311729495/1432422823, -10304129995/1701304382, -48777925059/3047939560, 15336726248/1032824649, -45442868181/3398467696, 3065993473/597172653, 0, 0],
#                 [1, 185892177/718116043, 0, 0, -3185094517/667107341, -477755414/1098053517, -703635378/230739211, 5731566787/1027545527, 5232866602/850066563, -4093664535/808688257, 3962137247/1805957418, 65686358/487910083, 0],
#                 [1, 13451932/455176623, 0, 0, 0, 0, -808719846/976000145, 1757004468/5645159321, 656045339/265891186, -3867574721/1518517206, 465885868/322736535,  53011238/667516719, 2/45],
#                 [1, -8, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]], dtype=myfloat)


# undo word wrap
feagin_10_8 = np.array([
                [0.,                                           0.,                                           0.,                                          0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [1./10.,                                       1./10.,                                       0.,                                          0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [53935784080298178753./100000000000000000000., -22879414034382286013./25000000000000000000., 29090688043565464561./20000000000000000000., 0.,                                            0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [8090367612044726813./10000000000000000000.,   2528239878763977129./12500000000000000000.,   0.,                                          60677757090335451097./100000000000000000000.,  0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [3090367612044726813./10000000000000000000.,   3680494294172871503./20000000000000000000.,   0.,                                          19796683122719236907./100000000000000000000.,  -1823869618284081573./25000000000000000000., 0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [3924296760879181073./4000000000000000000.,    8790073402066813373./100000000000000000000.,  0.,                                          0.,                                            10261492563006516133./25000000000000000000., 1206784384197166223./2500000000000000000.,    0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [83333333333333333333./100000000000000000000., 4298502524512301511./50000000000000000000.,   0.,                                          0.,                                            6617719260814443679./20000000000000000000.,  12241573932736254821./25000000000000000000.,  -914820468838563421./12500000000000000000.,    0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [35401736585680237633./100000000000000000000., 6046522456266686033./50000000000000000000.,   0.,                                          0.,                                            0.,                                          26012467575829562281./100000000000000000000., 1627013107745456651./50000000000000000000.,    -186181316192925313./3125000000000000000.,     0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [88252766196473234643./100000000000000000000., 11085437958039148351./100000000000000000000., 0.,                                          0.,                                            0.,                                          0.,                                           -1514403720637513969./25000000000000000000.,   3217637056017783901./10000000000000000000.,    25524286280403151579./50000000000000000000.,   0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [2008174244501007963./3125000000000000000.,    11205441475287900483./100000000000000000000., 0.,                                          0.,                                            0.,                                          0.,                                           -14494277590286591567./100000000000000000000., -33326971909625670659./100000000000000000000., 9985384591137601227./20000000000000000000.,    6368807611621076303./12500000000000000000.,   0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [1116825755498992037./3125000000000000000.,    5698839198209299307./50000000000000000000.,   0.,                                          0.,                                            0.,                                          0.,                                           -3844066821016784693./50000000000000000000.,   23952736032439064911./100000000000000000000.,  7955493247361892781./20000000000000000000.,    268897392184018639./25000000000000000000.,    -6555382483280377483./20000000000000000000.,    0.,                                             0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [11747233803526765357./100000000000000000000., 498946580175122529./6250000000000000000.,     0.,                                          0.,                                            0.,                                          0.,                                           -1040659373601206153./20000000000000000000.,   -5769541461685488817./100000000000000000000.,  9739095785605208249./50000000000000000000.,    14538492318832506973./100000000000000000000., -122334798492448559./1562500000000000000.,      -5725164968054945609./50000000000000000000.,    0.,                                            0.,                                           0.,                                            0.,                                           0.,       0.],
                [83333333333333333333./100000000000000000000., 24627890254121432003./25000000000000000000.,  0.,                                          0.,                                            6617719260814443679./20000000000000000000.,  12241573932736254821./25000000000000000000.,  -68948243287421783791./50000000000000000000.,  -86116419502763566667./100000000000000000000., 578428813637537220023./100000000000000000000., 32880776198510356689./10000000000000000000.,  -238633905093136384013./100000000000000000000., -65095868496728783731./20000000000000000000.,   -108171770843211491177./50000000000000000000., 0.,                                           0.,                                            0.,                                           0.,       0.],
                [3090367612044726813./10000000000000000000.,   17901605915432657821./20000000000000000000.,  0.,                                          19796683122719236907./100000000000000000000.,  -1823869618284081573./25000000000000000000., 0.,                                           -42561811983100380987./50000000000000000000.,  9958002807963332543./25000000000000000000.,    363937263181035606029./100000000000000000000., 30964575407966064473./20000000000000000000.,  -106110857352026858013./50000000000000000000.,  -158350398545326172713./100000000000000000000., -85780804142968132461./50000000000000000000.,  -2440364057501274521./100000000000000000000., 0.,                                            0.,                                           0.,       0.],
                [53935784080298178753./100000000000000000000., -22879414034382286013./25000000000000000000., 29090688043565464561./20000000000000000000., 0.,                                            0.,                                          -38866682182248411677./50000000000000000000., 0.,                                            -1138619577693970087./12500000000000000000.,   0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            1138619577693970087./12500000000000000000.,   38866682182248411677./50000000000000000000.,   0.,                                           0.,       0.],
                [1./10.,                                       1./10.,                                       0.,                                          -15717866579977116337./100000000000000000000., 0.,                                          0.,                                           0.,                                            0.,                                            0.,                                            0.,                                           0.,                                             0.,                                             0.,                                            0.,                                           0.,                                            15717866579977116337./100000000000000000000., 0.,       0.],
                [1./1.,                                        18178130070009528389./100000000000000000000., 27./40.,                                     17137907992359491997./50000000000000000000.,   0.,                                          25911121454832274451./100000000000000000000., -7165579334359041781./20000000000000000000.,   -20918979188176661219./20000000000000000000.,  93032784541562698329./100000000000000000000.,  88975479715854051223./50000000000000000000.,  1./10.,                                         -28254756953904408161./100000000000000000000.,  -15932735011997254917./100000000000000000000., -7275794732350075543./50000000000000000000.,  -25911121454832274451./100000000000000000000., -17137907992359491997./50000000000000000000., -27./40., 0.],
                [1, 3333333333333333333./100000000000000000000., 1./40., 3333333333333333333./100000000000000000000., 0., 1./20., 0., 1./25., 0., 2365468476861543627./12500000000000000000., 27742918851774317651./100000000000000000000., 27742918851774317651./100000000000000000000., 2365468476861543627./12500000000000000000., -1./25., -1./20., -3333333333333333333./100000000000000000000., -1./40., 3333333333333333333./100000000000000000000.],
                [1, 3333333333333333333./100000000000000000000., 1./36., 3333333333333333333./100000000000000000000., 0., 1./20., 0., 1./25., 0., 2365468476861543627./12500000000000000000., 27742918851774317651./100000000000000000000., 27742918851774317651./100000000000000000000., 2365468476861543627./12500000000000000000., -1./25., -1./20., -3333333333333333333./100000000000000000000., -1./36., 3333333333333333333./100000000000000000000.]], dtype = myfloat)

# undo word wrap
feagin_14_12 = np.array([
                [0.,                                     0.,                                         0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [11111111111111111./100000000000000000., 11111111111111111./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [13888888888888889./25000000000000000.,  -83333333333333333./100000000000000000.,    138888888888888889./100000000000000000., 0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [83333333333333333./100000000000000000., 20833333333333333./100000000000000000.,     0.,                                      5./8.,                                  0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [33333333333333333./100000000000000000., 19333333333333333./100000000000000000.,     0.,                                      11./50.,                                -2./25.,                              0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [1./1.,                                  1./10.,                                     0.,                                      0.,                                     2./5.,                                1./2.,                                 0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16749674481819323./25000000000000000.,  5174228081833989./50000000000000000.,       0.,                                      0.,                                     6103444365320361./50000000000000000., 24128724516562331./50000000000000000., -381409600015607./10000000000000000.,  0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [7426709605345459./25000000000000000.,   12438052665409441./100000000000000000.,     0.,                                      0.,                                     0.,                                   2261202821975843./10000000000000000.,  1378858876180809./100000000000000000., -1680525334991711./25000000000000000.,  0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [72727272727272727./100000000000000000., 4684595328298369./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    -613406843450511./100000000000000000., 10800991281275153./50000000000000000.,  21184753175788097./50000000000000000.,  0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [14015279904218877./100000000000000000., 8384798124090527./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    -589746835504869./50000000000000000.,  -4945980411376253./20000000000000000.,  978080858367729./10000000000000000.,    21759068924342063./100000000000000000.,  0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [35035051988507537./50000000000000000.,  3076276798847141./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    592232780324503./100000000000000000.,  47032615996384111./100000000000000000., 299688863848679./1000000000000000.,     -24765687759399491./100000000000000000., 1386187872142971./12500000000000000.,    0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9090909090909091./25000000000000000.,   2098500366813913./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    -63597539253241./20000000000000000.,   10079971436327401./12500000000000000.,  975983126412389./10000000000000000.,    77857557815839891./100000000000000000.,  20489042383159943./100000000000000000.,  -39065394906867047./25000000000000000.,   0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [26315789473684211./100000000000000000., 2188633911168651./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     124873005504039./20000000000000000.,     20004309710957731./100000000000000000.,  -805328367804983./100000000000000000.,    423035056134793./20000000000000000.,    0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [3921722466502709./100000000000000000.,  1417496251817573./50000000000000000.,       0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     249163204855817./100000000000000000.,    2301387878545931./100000000000000000.,   -322155956692977./100000000000000000.,    197688509889533./20000000000000000.,    -1065053856644437./50000000000000000.,      0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [20322937573209419./25000000000000000.,  343511894290243./1000000000000000.,         0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     21045191202362739./100000000000000000.,  25856863014307603./25000000000000000.,   300151822932211./50000000000000000.,      42796906254980977./50000000000000000.,  -97723500503676681./100000000000000000.,    -66002698047929469./100000000000000000.,    0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16666666666666667./100000000000000000., -1435740016721681./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -4578165875613./125000000000000.,        3502549756362137./100000000000000000.,   721892032724227./20000000000000000.,      -2652199675536811./100000000000000000., 4456990113056981./100000000000000000.,      777144333320989./6250000000000000.,         413829693239481./100000000000000000.,     0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9./10.,                                 35603240442512029./100000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -2250963794737813./5000000000000000.,    4305279070837109./10000000000000000.,    3199831431318889./6250000000000000.,      45415181944320213./50000000000000000.,  -30980273342983483./25000000000000000.,     -64904866167176147./100000000000000000.,    25170890458681929./100000000000000000.,   974883087931983./1250000000000000.,        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [6412992574519669./100000000000000000.,  1309356874065131./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -9320530679851./100000000000000000.,        2526871671311497./50000000000000000.,       40223517097./50000000000000000.,          59172602949417./100000000000000000.,       -8032294443./20000000000000000.,         0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [4082998185668577./20000000000000000.,   207926484466053./10000000000000000.,        0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     58269591880009./100000000000000000.,        -25053147886213./3125000000000000.,         403847643847./100000000000000000.,        8546099980555061./100000000000000000.,     -25560810117./12500000000000000.,        10532857882443189./100000000000000000.,    0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [39535039104876057./100000000000000000., 140153449795736021./100000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -11512600049211063./50000000000000000.,     -360553420233456453./50000000000000000.,    93225390173709./25000000000000000.,       -471415495727125021./100000000000000000.,  -176367657545349./100000000000000000.,   382065274019349383./50000000000000000.,    70120408731950367./20000000000000000.,    0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [60464960895123943./100000000000000000., 298786626735301717./25000000000000000.,     0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     779480932108175969./100000000000000000.,    -225800557546930317./4000000000000000.,     9123763069306449./100000000000000000.,    -636681399627174431./50000000000000000.,   -3968959219047197./100000000000000000.,  544392141883570887./10000000000000000.,    -364411637921569237./100000000000000000., -80450324991050991./100000000000000000., 0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [15917001814331423./20000000000000000.,  -14880942650710048843./100000000000000000., 0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -2293238195728141211./25000000000000000.,   70765614497159835983./100000000000000000.,  -110563611857482441./100000000000000000., 17613459188381137259./100000000000000000., 24569241210744033./50000000000000000.,   -17106950011245373609./25000000000000000., 279910604998398259./10000000000000000.,   659698550151411667./50000000000000000.,  25025756256796089./20000000000000000.,   0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [93587007425480331./100000000000000000., -241826986737049191./25000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     -446990150858505531./100000000000000000.,   227563564345476341./5000000000000000.,      -7130850861838269./100000000000000000.,   140342017585515927./12500000000000000.,    394513677242571./3125000000000000.,      -272149587218427071./6250000000000000.,    39358715377152949./50000000000000000.,    26613234837234211./50000000000000000.,   42242273399632533./100000000000000000.,  8591312495030671./100000000000000000.,   0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16666666666666667./100000000000000000., -62915020279409189./6250000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     -4578165875613./125000000000000.,        3502549756362137./100000000000000000.,   721892032724227./20000000000000000.,      -2652199675536811./100000000000000000., -39193060761341509./6250000000000000.,      4820792374425629891./100000000000000000.,   -868089611420207./12500000000000000.,     1268106902048502957./100000000000000000.,  598355844841619./50000000000000000.,     -58406220624060301./1250000000000000.,     133029613326626711./100000000000000000.,  50383393751699149./50000000000000000.,   2095120519336651./100000000000000000.,   1050673531656321./50000000000000000.,    476098007208561./50000000000000000.,   0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [20322937573209419./25000000000000000.,  -40947808167774370877./100000000000000000., 0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     21045191202362739./100000000000000000.,  25856863014307603./25000000000000000.,   300151822932211./50000000000000000.,      42796906254980977./50000000000000000.,  -25051699854744786049./100000000000000000., 97321233326194213883./50000000000000000.,   -152251941051155183./50000000000000000.,  6132829744103521419./12500000000000000.,   156647589531270907./100000000000000000., -94098714497005586681./50000000000000000., 7525922247248471753./100000000000000000., 864335892450827669./25000000000000000.,  321147679440968961./100000000000000000., -46040804173841439./100000000000000000., -1741436679683621./20000000000000000., -184837953539575767./25000000000000000.,  0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [3921722466502709./100000000000000000.,  343347475853550879./100000000000000000.,    0.,                                      0.,                                     0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     249163204855817./100000000000000000.,    2301387878545931./100000000000000000.,   -322155956692977./100000000000000000.,    197688509889533./20000000000000000.,    54063199844480627./25000000000000000.,      -1626998645464574213./100000000000000000.,  -2570690042410491./20000000000000000.,    -898915042666504253./100000000000000000.,  -13943814529281./4000000000000000.,      63174477645335923./4000000000000000.,      -57440333091409507./100000000000000000.,  -3456020390213933./10000000000000000.,   -132448298041317./20000000000000000.,    -194447032310551./25000000000000000.,    -14243367696091./4000000000000000.,    1198206266124827./250000000000000.,       7686273243653429./50000000000000000.,    0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [9090909090909091./25000000000000000.,   3230385208719854423./100000000000000000.,   0.,                                      0.,                                     0.,                                   0.,                                    -63597539253241./20000000000000000.,   10079971436327401./12500000000000000.,  975983126412389./10000000000000000.,    77857557815839891./100000000000000000.,  20489042383159943./100000000000000000.,  -39065394906867047./25000000000000000.,   0.,                                     817149459411552853./50000000000000000.,     -15454455529354362123./100000000000000000., 156971088703334873./100000000000000000.,  327685545087248131./100000000000000000.,   -1258723112984133./25000000000000000.,   15332115185804166507./100000000000000000., 44848011645482531./6250000000000000.,     -147018374337650241./50000000000000000., -6658459460768031./100000000000000000.,  -4623460549908437./100000000000000000.,  -1020993667928397./50000000000000000., -1067046212877471701./20000000000000000., -27109742943015731./20000000000000000.,  -9824767237577047./6250000000000000.,     0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [35035051988507537./50000000000000000.,  -1664514674863415129./100000000000000000.,  0.,                                      0.,                                     0.,                                   0.,                                    592232780324503./100000000000000000.,  47032615996384111./100000000000000000., 299688863848679./1000000000000000.,     -24765687759399491./100000000000000000., 1386187872142971./12500000000000000.,    0.,                                       -9834380876924583./20000000000000000.,  -114743154427289497./10000000000000000.,    321037266630492109./4000000000000000.,      -7682646079600857./20000000000000000.,    728147667468107583./100000000000000000.,   -6634969230612419./50000000000000000.,   -8107998325257307267./100000000000000000., -781484330222629./625000000000000.,       259263594969543681./100000000000000000., -15072014917320227./50000000000000000.,  11069223039491617./50000000000000000.,   8275772747718929./100000000000000000., 379921324081223041./20000000000000000.,   26923194640963969./100000000000000000.,  162674827447066537./100000000000000000.,  9834380876924583./20000000000000000.,    0.,                                       0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [14015279904218877./100000000000000000., 8384798124090527./100000000000000000.,      0.,                                      0.,                                     0.,                                   0.,                                    -589746835504869./50000000000000000.,  -4945980411376253./20000000000000000.,  978080858367729./10000000000000000.,    21759068924342063./100000000000000000.,  0.,                                      6879280338166261./50000000000000000.,     4398702297150467./100000000000000000.,  0.,                                         -25685040688409667./50000000000000000.,     82635569115131551./100000000000000000.,   1285090698599059163./50000000000000000.,   0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    -1285090698599059163./50000000000000000., -82635569115131551./100000000000000000., 25685040688409667./50000000000000000.,    -4398702297150467./100000000000000000.,  -6879280338166261./50000000000000000.,    0.,                                     0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [7426709605345459./25000000000000000.,   12438052665409441./100000000000000000.,     0.,                                      0.,                                     0.,                                   2261202821975843./10000000000000000.,  1378858876180809./100000000000000000., -1680525334991711./25000000000000000.,  0.,                                     0.,                                      -17124779501708567./20000000000000000.,  -196337522866858909./100000000000000000., -1161664113620597./5000000000000000.,   0.,                                         430660719086453349./100000000000000000.,    -292722963249465483./100000000000000000., -1646263332795717889./20000000000000000.,  0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    1646263332795717889./20000000000000000.,  292722963249465483./100000000000000000., -430660719086453349./100000000000000000., 1161664113620597./5000000000000000.,     196337522866858909./100000000000000000.,  17124779501708567./20000000000000000.,  0.,                                      0.,                                     0.,        0.,                                    0.,                                      0.],
                [16749674481819323./25000000000000000.,  5174228081833989./50000000000000000.,       0.,                                      0.,                                     6103444365320361./50000000000000000., 24128724516562331./50000000000000000., -381409600015607./10000000000000000.,  0.,                                     -6881244066385029./12500000000000000.,  0.,                                      -71191581158518923./100000000000000000., -29206480283577567./50000000000000000.,   0.,                                     0.,                                         52761577031466233./25000000000000000.,      -8374947367395721./100000000000000000.,   255010749536160457./50000000000000000.,    0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    -255010749536160457./50000000000000000.,  8374947367395721./100000000000000000.,   -52761577031466233./25000000000000000.,   0.,                                      29206480283577567./50000000000000000.,    71191581158518923./100000000000000000., 6881244066385029./12500000000000000.,    0.,                                     0.,        0.,                                    0.,                                      0.],
                [33333333333333333./100000000000000000., 19333333333333333./100000000000000000.,     0.,                                      11./50.,                                -2./25.,                              0.,                                    0.,                                    1099934255807247./10000000000000000.,   -3178713100953377./12500000000000000.,  0.,                                      3462283108466777./4000000000000000.,     332416449114093083./100000000000000000.,  0.,                                     0.,                                         -1201022233159779339./100000000000000000.,  11915036656062331./25000000000000000.,    -580486022442072781./20000000000000000.,   0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    580486022442072781./20000000000000000.,   -11915036656062331./25000000000000000.,  1201022233159779339./100000000000000000., 0.,                                      -332416449114093083./100000000000000000., -3462283108466777./4000000000000000.,   3178713100953377./12500000000000000.,    -1099934255807247./10000000000000000.,  0.,        0.,                                    0.,                                      0.],
                [13888888888888889./25000000000000000.,  -83333333333333333./100000000000000000.,    138888888888888889./100000000000000000., 0.,                                     0.,                                   -3./4.,                                0.,                                    -4925295437180263./10000000000000000.,  0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      4925295437180263./10000000000000000.,   3./4.,     0.,                                    0.,                                      0.],
                [11111111111111111./100000000000000000., 11111111111111111./100000000000000000.,     0.,                                      -11111111111111111./50000000000000000., 0.,                                   0.,                                    0.,                                    0.,                                     0.,                                     0.,                                      0.,                                      0.,                                       0.,                                     0.,                                         0.,                                         0.,                                       0.,                                        0.,                                      0.,                                        0.,                                       0.,                                      0.,                                      0.,                                      0.,                                    0.,                                       0.,                                      0.,                                       0.,                                      0.,                                       0.,                                     0.,                                      0.,                                     0.,        11111111111111111./50000000000000000., 0.,                                      0.],
                [1./1.,                                  7145878509724289./25000000000000000.,       29166666666666667./100000000000000000.,  7./32.,                                 0.,                                   21./128.,                              0.,                                    10909717747277833./50000000000000000.,  18039289847869777./100000000000000000., 0.,                                      10285691970242251./50000000000000000.,   94810856086629./390625000000000.,         24646578081362931./100000000000000000., -13799677631635633./4000000000000000.,      2860944527000451./12500000000000000.,       14164529985107571./50000000000000000.,    321085125837766641./100000000000000000.,   -2235387773648457./10000000000000000.,   -70712115720441907./100000000000000000.,   8028083628757177./2500000000000000.,      70477174154834883./50000000000000000.,   -15136205344374261./100000000000000000., 9308764363175357./25000000000000000.,    12648937320318067./50000000000000000., -321085125837766641./100000000000000000., -14164529985107571./50000000000000000.,  -2860944527000451./12500000000000000.,    -24646578081362931./100000000000000000., -94810856086629./390625000000000.,        -10285691970242251./50000000000000000., -18039289847869777./100000000000000000., -10909717747277833./50000000000000000., -21./128., -7./32.,                               -29166666666666667./100000000000000000., 0.],
                [1., 892857142857143./50000000000000000., 3./512., 3./256., 0., 9./512., 0., 3./128., 15./512., 0., 9./256., 21./512., 3./64., 0., 27./512., 15./256., 33./512., 0., 5267605678587651./50000000000000000., 8528067312087609./50000000000000000., 10311469866467597./50000000000000000., 10311469866467597./50000000000000000., 8528067312087609./50000000000000000., 5267605678587651./50000000000000000., -33./512., -15./256., -27./512., -3./64., -21./512., -9./256., -15./512., -3./128., -9./512., -3./256., -3./512., 892857142857143./50000000000000000.],
                [1., 892857142857143./50000000000000000., 242968749999999999./50000000000000000000., 3./256., 0., 9./512., 0., 3./128., 15./512., 0., 9./256., 21./512., 3./64., 0., 27./512., 15./256., 33./512., 0., 5267605678587651./50000000000000000., 8528067312087609./50000000000000000., 10311469866467597./50000000000000000., 10311469866467597./50000000000000000., 8528067312087609./50000000000000000., 5267605678587651./50000000000000000., -33./512., -15./256., -27./512., -3./64., -21./512., -9./256., -15./512., -3./128., -9./512., -3./256., -242968749999999999./50000000000000000000., 892857142857143./50000000000000000.]], dtype = myfloat)
#--------------------------------------------------------------------------------------------------





# standard RK methods (implicit):


# low order (1-3):
#--------------------------------------------------------------------------------------------------
backward_euler_1 = np.array([
                [1, 1],
                [1, 1]], dtype = myfloat)

implicit_midpoint_2 = np.array([
                [1/2, 1/2],
                [1, 1]], dtype = myfloat)         # symplectic integrator (any way to characterize automatically?)

crank_nicolson_2 = np.array([
                [0, 0, 0],
                [1, 1/2, 1/2],
                [1, 1/2, 1/2]], dtype = myfloat)

qin_zhang_2 = np.array([
                [1/4, 1/4, 0],
                [3/4, 1/2, 1/4],
                [1, 1/2, 1/2]], dtype = myfloat)  # symplectic

kraaijevanger_spijker_2 = np.array([
                [1/2, 1/2, 0],
                [3/2, -1/2, 2],
                [1, -1/2, 3/2]], dtype = myfloat)

gamma = 1 - 1/(2**0.5)      # https://arxiv.org/pdf/1009.2757.pdf

pareschi_russo_2 = np.array([
                [gamma, gamma, 0],
                [1 - gamma, 1 - 2*gamma, gamma],
                [1, 1/2, 1/2]], dtype = myfloat)

lobatto_IIIB_2 = np.array([
                [1/2, 1/2, 0],
                [1/2, 1/2, 0],
                [1, 1/2, 1/2]], dtype = myfloat)

lobatto_IIIC_2 = np.array([
                [0, 1/2, -1/2],
                [1, 1/2, 1/2],
                [1, 1/2, 1/2]], dtype = myfloat)

pareschi_russo_3 = np.array([
                [gamma, gamma, 0, 0],
                [1 - gamma, 1 - 2*gamma, gamma, 0],
                [1/2, 1/2 - gamma, 0, gamma],
                [1, 1/6, 1/6, 2/3]], dtype = myfloat)

crouzeix_3 = np.array([
                [1/2 + (3**0.5)/6, 1/2 + (3**0.5)/6, 0],
                [1/2 - (3**0.5)/6, -(3**0.5)/3, 1/2 + (3**0.5)/6],
                [1, 1/2, 1/2]], dtype = myfloat)

radau_IA_3 = np.array([
                [0, 1/4, -1/4],
                [2/3, 1/4, 5/12],
                [1, 1/4, 3/4]], dtype = myfloat)

radau_IIA_3 = np.array([
                [1/3, 5/12, -1/12],
                [1, 3/4, 1/4],
                [1, 3/4, 1/4]], dtype = myfloat)

# 3rd order DIRK L Stable (wiki)
DIRK_L_3 = np.array([
                [1/2, 1/2, 0, 0, 0],
                [2/3, 1/6, 1/2, 0, 0],
                [1/2, -1/2, 1/2, 1/2, 0],
                [1, 3/2, -3/2, 1/2, 1/2],
                [1, 3/2, -3/2, 1/2, 1/2]], dtype = myfloat)




# radau_IIA_5

#--------------------------------------------------------------------------------------------------


# mid order (4-6)
#--------------------------------------------------------------------------------------------------
x1 = 1.06857902130163       # https://en.wikipedia.org/wiki/List_of_Runge%E2%80%93Kutta_methods

norsett_4 = np.array([
                [x1, x1, 0, 0],
                [1/2, 1/2 - x1, x1, 0],
                [1 - x1, 2*x1, 1 - 4*x1, x1],
                [1, 1/(6*(1 - 2*x1)**2), 1 - 1/(3*(1 - 2*x1)**2), 1/(6*(1 - 2*x1)**2)]], dtype = myfloat)

lobatto_IIIA_4 = np.array([
                [0, 0, 0, 0],
                [1/2, 5/24, 1/3, -1/24],
                [1, 1/6, 2/3, 1/6],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

lobatto_IIIB_4 = np.array([
                [0, 1/6, -1/6, 0],
                [1/2, 1/6, 1/3, 0],
                [1, 1/6, 5/6, 0],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

lobatto_IIIC_4 = np.array([
                [0, 1/6, -1/3, 1/6],
                [1/2, 1/6, 5/12, -1/12],
                [1, 1/6, 2/3, 1/6],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

# IIICS = IIIC*
lobatto_IIICS_4 = np.array([
                [0, 0, 0, 0],
                [1/2, 1/4, 1/4, 0],
                [1, 0, 1, 0],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

lobatto_IIID_4 = np.array([
                [0, 1/6, 0, -1/6],
                [1/2, 1/12, 5/12, 0],
                [1, 1/2, 1/3, 1/6],
                [1, 1/6, 2/3, 1/6]], dtype = myfloat)

sqrt_3 = 3**0.5

gauss_legendre_4 = np.array([
                [1/2 - sqrt_3/6, 1/4, 1/4 - sqrt_3 /6],
                [1/2 + sqrt_3 /6, 1/4 + sqrt_3 /6, 1/4],
                [1, 1/2, 1/2]], dtype = myfloat)

sqrt_6 = 6**0.5

radau_IA_5 = np.array([
                [0, 1/9, -(1 + sqrt_6)/18, (-1 + sqrt_6)/18],
                [3/5 - sqrt_6/10, 1/9, 11/45 + 7*sqrt_6/360, 11/45 - 43*sqrt_6/360],
                [3/5 + sqrt_6/10, 1/9, 11/45 + 43*sqrt_6/360, 11/45 - 7*sqrt_6/360],
                [1, 1/9, 4/9 + sqrt_6/36, 4/9 - sqrt_6/36]], dtype = myfloat)

radau_IIA_5 = np.array([
                [2/5 - sqrt_6/10, 11/45 - 7*sqrt_6/360, 37/225 - 169*sqrt_6/1800, -2/225 + sqrt_6/75],
                [2/5 + sqrt_6/10, 37/225 + 169*sqrt_6/1800, 11/45 + 7*sqrt_6/360, -2/225 - sqrt_6/75],
                [1, 4/9 - sqrt_6/36, 4/9 + sqrt_6/36, 1/9],
                [1, 4/9 - sqrt_6/36, 4/9 + sqrt_6/36, 1/9]], dtype = myfloat)

sqrt_15 = 15**0.5

gauss_legendre_6 = np.array([
                [1/2 - sqrt_15/10, 5/36, 2/9 - sqrt_15/15, 5/36 - sqrt_15/30],
                [1/2, 5/36 + sqrt_15/24, 2/9, 5/36 - sqrt_15/24],
                [1/2 + sqrt_15/10, 5/36 + sqrt_15/30, 2/9 + sqrt_15/15, 5/36],
                [1, 5/18, 4/9, 5/18]], dtype = myfloat)


# embedded RK methods (implicit):


# low order (1-3):
#--------------------------------------------------------------------------------------------------
crank_nicolson_2_1 = np.array([
                [0, 0, 0],
                [1, 1/2, 1/2],
                [1, 1/2, 1/2],
                [1, 1, 0]], dtype = myfloat)

# confused (I though implicit midpoint is 2nd order)
lobatto_IIIB_2_1 = np.array([
                [1/2, 1/2, 0],
                [1/2, 1/2, 0],
                [1, 1/2, 1/2],
                [1, 1, 0]], dtype = myfloat)

lobatto_IIIC_2_1 = np.array([
                [0, 1/2, -1/2],
                [1, 1/2, 1/2],
                [1, 1/2, 1/2],
                [1, 1, 0]], dtype = myfloat)


# mid order (4-6)
#--------------------------------------------------------------------------------------------------

# no idea what order these secondary pairs have...

lobatto_IIIA_4_2 = np.array([
                [0, 0, 0, 0],
                [1/2, 5/24, 1/3, -1/24],
                [1, 1/6, 2/3, 1/6],
                [1, 1/6, 2/3, 1/6],
                [1, -1/2, 2, -1/2]], dtype = myfloat)

lobatto_IIIB_4_2 = np.array([
                [0, 1/6, -1/6, 0],
                [1/2, 1/6, 1/3, 0],
                [1, 1/6, 5/6, 0],
                [1, 1/6, 2/3, 1/6],
                [1, -1/2, 2, -1/2]], dtype = myfloat)

# this one is 4(2)
lobatto_IIIC_4_2 = np.array([
                [0, 1/6, -1/3, 1/6],
                [1/2, 1/6, 5/12, -1/12],
                [1, 1/6, 2/3, 1/6],
                [1, 1/6, 2/3, 1/6],
                [1, -1/2, 2, -1/2]], dtype = myfloat)

# IIICS = IIIC*
lobatto_IIICS_4_2 = np.array([
                [0, 0, 0, 0],
                [1/2, 1/4, 1/4, 0],
                [1, 0, 1, 0],
                [1, 1/6, 2/3, 1/6],
                [1, -1/2, 2, -1/2]], dtype = myfloat)

lobatto_IIID_4_2 = np.array([
                [0, 1/6, 0, -1/6],
                [1/2, 1/12, 5/12, 0],
                [1, 1/2, 1/3, 1/6],
                [1, 1/6, 2/3, 1/6],
                [1, -1/2, 2, -1/2]], dtype = myfloat)

# radau_IIA_5_2

gauss_legendre_4_2 = np.array([
                [1/2 - sqrt_3/6, 1/4, 1/4 - sqrt_3/6],
                [1/2 + sqrt_3/6, 1/4 + sqrt_3/6, 1/4],
                [1, 1/2, 1/2],
                [1, 1/2 + sqrt_3/2, 1/2 - sqrt_3/2]], dtype = myfloat)

radau_IIA_5_2 = np.array([
                [2/5 - sqrt_6/10, 11/45 - 7*sqrt_6/360, 37/225 - 169*sqrt_6/1800, -2/225 + sqrt_6/75],
                [2/5 + sqrt_6/10, 37/225 + 169*sqrt_6/1800, 11/45 + 7*sqrt_6/360, -2/225 - sqrt_6/75],
                [1, 4/9 - sqrt_6/36, 4/9 + sqrt_6/36, 1/9],
                [1, 4/9 - sqrt_6/36, 4/9 + sqrt_6/36, 1/9],
                [1, 1 - 7*sqrt_6/12, 1 + 7*sqrt_6/12, -1]], dtype = myfloat)

# not sure is 6(4) is correct
gauss_legendre_6_4 = np.array([
                [1/2 - sqrt_15/10, 5/36, 2/9 - sqrt_15/15, 5/36 - sqrt_15/30],
                [1/2, 5/36 + sqrt_15/24, 2/9, 5/36 - sqrt_15/24],
                [1/2 + sqrt_15/10, 5/36 + sqrt_15/30, 2/9 + sqrt_15/15, 5/36],
                [1, 5/18, 4/9, 5/18],
                [1, -5/6, 8/3, -5/6]], dtype = myfloat)



# dictionaries
#--------------------------------------------------------------------------------------------------
standard_runge_kutta_dict = {'E1':       ['euler_1',                 euler_1],                # explicit
                             'H2':       ['heun_2',                  heun_2],                 # SSP (strong stability preserving)
                             'M2':       ['midpoint_2',              midpoint_2],
                             'R2':       ['ralston_2',               ralston_2],
                             'H3':       ['heun_3',                  heun_3],
                             'R3':       ['ralston_3',               ralston_3],
                             'RK3':      ['runge_kutta_3',           runge_kutta_3],
                             'SSPSO3':   ['ssp_shu_osher_3',         ssp_shu_osher_3],
                             'SSPSR3':   ['ssp_spiteri_ruuth_3',     ssp_spiteri_ruuth_3],
                             'RK4':      ['runge_kutta_4',           runge_kutta_4],
                             'TER4':     ['three_eights_rule_4',     three_eights_rule_4],
                             'R4':       ['ralston_4',               ralston_4],
                             'SSPK4':    ['ssp_ketcheson_4',         ssp_ketcheson_4],
                             'F4':       ['fehlberg_4',              fehlberg_4],
                             'B5':       ['butcher_5',               butcher_5],
                             'CK5':      ['cash_karp_5',             cash_karp_5],
                             'DP5':      ['dormand_prince_5',        dormand_prince_5],
                             'BS5':      ['bogacki_shampine_5',      bogacki_shampine_5],
                             'T5':       ['tsitouras_5',             tsitouras_5],
                             'V5':       ['verner_5',                verner_5],
                             'B6':       ['butcher_6',               butcher_6],
                             'V6':       ['verner_6',                verner_6],
                             'F7':       ['fehlberg_7',              fehlberg_7],
                             'C8':       ['curtis_8',                curtis_8],
                             'S8':       ['shanks_8',                shanks_8],
                             'SP8':      ['shanks_pseudo_8',         shanks_pseudo_8],
                             'DP8':      ['dormand_prince_8',        dormand_prince_8],
                             'F10':      ['feagin_10',               feagin_10],
                             'F14':      ['feagin_14',               feagin_14],

                             'BE1':      ['backward_euler_1',        backward_euler_1],       # implicit
                             'IM2':      ['implicit_midpoint_2',     implicit_midpoint_2],
                             'CN2':      ['crank_nicolson_2',        crank_nicolson_2],
                             'QZ2':      ['qin_zhang_2',             qin_zhang_2],
                             'PR2':      ['pareschi_russo_2',        pareschi_russo_2],
                             'LIIIB2':   ['lobatto_IIIB_2',          lobatto_IIIB_2],
                             'LIIIC2':   ['lobatto_IIIC_2',          lobatto_IIIC_2],
                             'KS2':      ['kraaijevanger_spijker_2', kraaijevanger_spijker_2],
                             'DIRKL3':   ['DIRK_L_3',                DIRK_L_3],
                             'PR3':      ['pareschi_russo_3',        pareschi_russo_3],
                             'C3':       ['crouzeix_3',              crouzeix_3],
                             'RIA3':     ['radau_IA_3',              radau_IA_3],
                             'RIIA3':    ['radau_IIA_3',             radau_IIA_3],
                             'N4':       ['norsett_4',               norsett_4],
                             'GL4':      ['gauss_legendre_4',        gauss_legendre_4],
                             'LIIIA4':   ['lobatto_IIIA_4',          lobatto_IIIA_4],
                             'LIIIB4':   ['lobatto_IIIB_4',          lobatto_IIIB_4],
                             'LIIIC4':   ['lobatto_IIIC_4',          lobatto_IIIC_4],
                             'LIIICS4':  ['lobatto_IIICS_4',         lobatto_IIICS_4],
                             'LIIID4':   ['lobatto_IIID_4',          lobatto_IIID_4],
                             'RIA5':     ['radau_IA_5',              radau_IA_5],
                             'RIIA5':    ['radau_IIA_5',             radau_IIA_5],
                             'GL6':      ['gauss_legendre_6',        gauss_legendre_6]
                            }


embedded_runge_kutta_dict = {'F12':      ['fehlberg_1_2',            fehlberg_1_2],           # explicit
                             'HE21':     ['heun_euler_2_1',          heun_euler_2_1],
                             'BS32':     ['bogacki_shampine_3_2',    bogacki_shampine_3_2],
                             'F45':      ['fehlberg_4_5',            fehlberg_4_5],
                             'CK54':     ['cash_karp_5_4',           cash_karp_5_4],
                             'DP54':     ['dormand_prince_5_4',      dormand_prince_5_4],
                             'BS54':     ['bogacki_shampine_5_4',    bogacki_shampine_5_4],
                             'T54':      ['tsitouras_5_4',           tsitouras_5_4],
                             'V56':      ['verner_5_6',              verner_5_6],              # free failed
                             'V65':      ['verner_6_5',              verner_6_5],
                             'F78':      ['fehlberg_7_8',            fehlberg_7_8],            # free failed
                             'DP87':     ['dormand_prince_8_7',      dormand_prince_8_7],
                             'F108':     ['feagin_10_8',             feagin_10_8],
                             'F1412':    ['feagin_14_12',            feagin_14_12],

                             'CN21':     ['crank_nicolson_2_1',      crank_nicolson_2_1],     # implicit
                             'LIIIB21':  ['lobatto_IIIB_2_1',        lobatto_IIIB_2_1],
                             'LIIIC21':  ['lobatto_IIIC_2_1',        lobatto_IIIC_2_1],
                             'GL42':     ['gauss_legendre_4_2',      gauss_legendre_4_2],
                             'LIIIA42':  ['lobatto_IIIA_4_2',        lobatto_IIIA_4_2],
                             'LIIIB42':  ['lobatto_IIIB_4_2',        lobatto_IIIB_4_2],
                             'LIIIC42':  ['lobatto_IIIC_4_2',        lobatto_IIIC_4_2],
                             'LIIICS42': ['lobatto_IIICS_4_2',       lobatto_IIICS_4_2],
                             'RIIA52':   ['radau_IIA_5_2',           radau_IIA_5_2],
                             'GL64':     ['gauss_legendre_6_4',      gauss_legendre_6_4]
                            }



# note: order of method is conveniently attached to file name
#--------------------------------------------------------------------------------------------------


def debug_table(method, butcher):
    # for testing table properties (within numerical precision):
    #   sum_i b_i = 1
    #   sum_j a_ij = c_i (not a strict condition)

    first_column = butcher[:,0]                                         # get the first column
    reduce_block = np.sum(butcher[:,1:], axis = 1)                      # for each row, sum the remaining columns

    error = np.linalg.norm(reduce_block - first_column, ord = np.inf)   # take the max error element

    if error > 1.e-14:
        print('\ndebug_table warning:', method, 'table does not satisfy usual conditions, error = %.3e (may need to debug table)\n' % error)



def method_is_FSAL(butcher, embedded = False):

    if embedded:
        if np.array_equal(butcher[-3,1:], butcher[-2,1:]):      # check if second-to-last and third-to-last rows match
            return 'FSAL'
        else:
            return 'not FSAL'
    else:

        # todo: whether or not implicit method can use FSAL is less obvious

        if np.array_equal(butcher[-2,1:], butcher[-1,1:]):      # check if last and second-to-last rows match
            return 'FSAL'
        else:
            return 'not FSAL'


def symplectic_method(butcher, embedded = False):

    if embedded:                                                        # get A_ij, b_i
        A = butcher[:-2, 1:]
        b = butcher[-2, 1:]
    else:
        A = butcher[:-1, 1:]
        b = butcher[-1, 1:]

    stages = len(b)
    matrix = np.zeros((stages,stages))

    for i in range(0, stages):
        for j in range(0, stages):
            matrix[i,j] = b[i] * A[i,j]  +  b[i] * A[j,i]  -  b[i] * b[j]

    if np.array_equal(matrix, np.zeros((stages,stages))):
        return 'symplectic'
    else:
        return 'not symplectic'


# check if butcher is explicit or diagonal (fully) impliciy (also for debugging table)
def explicit_or_implicit_method(butcher, embedded = False):

    if embedded:
        a = butcher[:-2, 1:]
    else:
        a = butcher[:-1, 1:]                                            # a_ij

    lower_triangular = np.allclose(a, np.tril(a))                       # check whether matrix is lower triangular

    if lower_triangular:

        diag_a = np.diag(a)                                             # diagonal of a_ij

        zero_diagonal = np.array_equal(diag_a, np.zeros(len(diag_a)))   # check whether diagonal elements are all zero

        if zero_diagonal:
            return 'explicit'
        else:
            return 'diagonal_implicit'
    else:
        return 'fully_implicit'



def main():
        for label in standard_runge_kutta_dict:                         # write butcher tables to file

                method = standard_runge_kutta_dict[label][0]
                table  = standard_runge_kutta_dict[label][1]

                print(method, '\t\t', explicit_or_implicit_method(table), '\t\t', symplectic_method(table), '\t\t', method_is_FSAL(table))

                debug_table(method, table)

                np.savetxt('tables/butcher/standard/' + method + '.dat', table)

        print()

        for label in embedded_runge_kutta_dict:

                method = embedded_runge_kutta_dict[label][0]
                table  = embedded_runge_kutta_dict[label][1]

                print(method, '\t\t', explicit_or_implicit_method(table, embedded = True), '\t\t',
                      symplectic_method(table, embedded = True), '\t\t', method_is_FSAL(table, embedded = True))

                debug_table(method, table)

                np.savetxt('tables/butcher/embedded/' + method + '.dat', table)


if __name__ == "__main__":
    main()







#------------------------------------------------------------------------------------------
# todo: warn users if their method isn't listed via dictionary


# todo: fix up feagin, remove tabs (it's a mess if you use word wrap) and use high-precision decimal values
# todo: try using decimal for high-order methods, https://zetcode.com/python/decimal/

# todo: add more methods
#       http://www.mymathlib.com/diffeq/embedded_runge_kutta/embedded_verner_5_6.html
#       https://diffeq.sciml.ai/stable/solvers/ode_solve/

# note: feagin's personal web pages are not secure (having a hard time finding decimal values)
# https://codereview.stackexchange.com/questions/83635/terry-feagins-10th-order-explicit-runge-kutta-method
# https://pypi.org/project/desolver/
# https://github.com/Microno95/desolver/blob/fd1b6a2813fc0b4c792dac05b5e1cb4a1f90b458/desolver/integrators/explicit_integration_schemes.py

# note: shanks_(8-10) was hard-coded with decimal values
#------------------------------------------------------------------------------------------

